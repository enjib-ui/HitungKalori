<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Kalkulator Kalori, Lemak & Olahraga</title>

<style>
  body { font-family: Arial; background:#eef3ff; padding:20px }
  .card { background:white; padding:18px; border-radius:14px; box-shadow:0 8px 20px rgba(0,0,0,.08); max-width:600px; margin:auto }
  h2 { margin-top:0 }
  label { font-weight:bold }
  select, input { width:100%; padding:10px; margin:8px 0 14px; border-radius:8px; border:1px solid #ccc }
  button { padding:10px 14px; border:none; border-radius:10px; color:white; font-weight:bold; cursor:pointer }
  .btn-main { background:#22c55e; width:100%; margin-top:6px }
  .btn-add { background:#3b82f6 }
  .result { margin-top:16px; background:#f0fdf4; padding:14px; border-radius:10px }
  table { width:100%; border-collapse:collapse; margin-top:6px }
  th,td { padding:8px; border-bottom:1px solid #ddd; font-size:14px }
  th { background:#f8fafc; text-align:left }
  small { color:#555 }
</style>
</head>

<body>
<div class="card">
  <h2>Kalkulator Kalori, Lemak & Rekomendasi Olahraga</h2>

  <!-- PILIH MAKANAN -->
  <label>Pilih makanan</label>
<select id="food">
  <option value="">-- pilih makanan --</option>

  <option value="210">Nasi putih (1 porsi ~ 210 kcal)</option>
  <option value="400">Mi goreng (1 porsi ~ 400 kcal)</option>
  <option value="260">Ayam goreng (1 potong ~ 260 kcal)</option>
  <option value="150">Roti tawar (2 lembar ~ 150 kcal)</option>
  <option value="130">Susu kotak (1 cup ~ 130 kcal)</option>
  <option value="250">Burger kecil (1 buah ~ 250 kcal)</option>
  <option value="150">Minuman manis (1 gelas ~ 150 kcal)</option>

  <option value="190">Gorengan (1 buah ~ 190 kcal)</option>
  <option value="450">Seblak (1 mangkuk ~ 450 kcal)</option>
  <option value="200">Cilok saus kacang (1 porsi ~ 200 kcal)</option>
  <option value="380">Bakso (1 mangkuk ~ 380 kcal)</option>
  <option value="600">Nasi goreng (1 porsi ~ 600 kcal)</option>
  <option value="480">Mie ayam (1 porsi ~ 480 kcal)</option>
  <option value="180">Tahu goreng (1 potong ~ 180 kcal)</option>
  <option value="190">Tempe goreng (1 potong ~ 190 kcal)</option>
  <option value="280">Donat (1 buah ~ 280 kcal)</option>
  <option value="240">Kentang goreng (1 porsi kecil ~ 240 kcal)</option>
  <option value="260">Sosis bakar (1 buah ~ 260 kcal)</option>
</select>

  <label>Berapa porsinya?</label>
  <input type="number" id="portion" min="1" value="1">

  <button class="btn-add" onclick="tambahMakanan()">+ Tambahkan ke daftar</button>

  <table id="listTable" style="display:none">
    <thead>
      <tr>
        <th>Makanan</th>
        <th>Porsi</th>
        <th>Kalori total</th>
        <th></th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <label>Berapa kali dikonsumsi dalam periode?</label>
  <input type="number" id="times" min="1" value="1">

  <label>Rentang waktu</label>
  <select id="period">
    <option value="1">Per hari</option>
    <option value="7">Per minggu</option>
    <option value="30">Per bulan</option>
  </select>

  <!-- DATA UNTUK TDEE -->
  <label>Jenis kelamin</label>
  <select id="gender">
    <option value="male">Laki-laki</option>
    <option value="female">Perempuan</option>
  </select>

  <label>Usia (tahun)</label>
  <input type="number" id="age" min="10" value="25">

  <label>Tinggi badan (cm)</label>
  <input type="number" id="height" min="120" value="165">

  <label>Berat badan (kg)</label>
  <input type="number" id="weight" min="30" value="60">

  <label>Tingkat aktivitas</label>
  <select id="activity">
    <option value="1.2">Sangat ringan (banyak duduk)</option>
    <option value="1.375">Ringan (olahraga 1â€“3x/minggu)</option>
    <option value="1.55">Sedang (3â€“5x/minggu)</option>
    <option value="1.725">Berat (6â€“7x/minggu)</option>
    <option value="1.9">Sangat berat</option>
  </select>

  <button class="btn-main" onclick="hitung()">Hitung Estimasi</button>

  <div id="output" class="result" style="display:none"></div>

  <small>
    *Estimasi edukatif. Hasil bisa berbeda tergantung usia, metabolisme, komposisi tubuh, dan aktivitas nyata.
  </small>
</div>

<script>
let daftar = [];

function tambahMakanan() {
  const select = document.getElementById("food");
  const cal = Number(select.value || 0);
  const name = select.options[select.selectedIndex].text;
  const portion = Number(document.getElementById("portion").value || 1);

  if (!cal) { alert("Silakan pilih makanan."); return; }

  daftar.push({ name, cal, portion });
  renderList();
}

function hapus(index) {
  daftar.splice(index, 1);
  renderList();
}

function renderList() {
  const table = document.getElementById("listTable");
  const body = table.querySelector("tbody");
  body.innerHTML = "";

  if (daftar.length === 0) {
    table.style.display = "none";
    return;
  }

  daftar.forEach((item, i) => {
    const total = item.cal * item.portion;
    body.innerHTML += `
      <tr>
        <td>${item.name}</td>
        <td>${item.portion}</td>
        <td>${total} kcal</td>
        <td><button onclick="hapus(${i})">Hapus</button></td>
      </tr>
    `;
  });

  table.style.display = "table";
}

function hitung() {
  if (daftar.length === 0) {
    alert("Tambahkan makanan terlebih dahulu.");
    return;
  }

  const times = Number(document.getElementById("times").value || 1);
  const period = Number(document.getElementById("period").value);

  const gender = document.getElementById("gender").value;
  const age = Number(document.getElementById("age").value);
  const height = Number(document.getElementById("height").value);
  const weight = Number(document.getElementById("weight").value);
  const activity = Number(document.getElementById("activity").value);

  const kaloriMakan = daftar.reduce((sum, i) => sum + (i.cal * i.portion), 0);
  const totalCalories = kaloriMakan * times;   // konsumsi per periode

  // --- BMR (Mifflin-St Jeor) ---
  let BMR;
  if (gender === "male") {
    BMR = 10 * weight + 6.25 * height - 5 * age + 5;
  } else {
    BMR = 10 * weight + 6.25 * height - 5 * age - 161;
  }

  // TDEE per hari
  const TDEE = BMR * activity;

  // TDEE untuk periode yang sama
  const tdeePeriod = TDEE * period;

  // selisih kalori
  const diff = totalCalories - tdeePeriod;

  // estimasi lemak (1 kg lemak â‰ˆ 7700 kcal â†’ 1 g â‰ˆ 7.7 kcal)
  const fatGrams = (Math.max(diff, 0) / 7.7).toFixed(1);

  const sports = [
    { name: "Jogging (sedang)", met: 7.0 },
    { name: "Bersepeda santai", met: 4.0 },
    { name: "Senam aerobik", met: 6.5 },
    { name: "Skipping (lompat tali)", met: 10.0 },
    { name: "Renang santai", met: 6.0 }
  ];

  let html = `
    <b>Total kalori makanan (periode ini):</b> ${totalCalories.toFixed(0)} kcal<br>
    <b>Kebutuhan tubuh (TDEE) periode ini:</b> ${tdeePeriod.toFixed(0)} kcal<br>
    <b>Selisih:</b> ${diff.toFixed(0)} kcal (${diff > 0 ? "surplus" : diff < 0 ? "defisit" : "seimbang"})<br><br>
  `;

  if (diff > 0) {
    html += `
      <b>Jika surplus ini tidak dikompensasi, estimasi lemak yang dapat terbentuk:</b>
      Â± <b>${fatGrams} gram</b><br><br>
      <b>Olahraga yang disarankan (untuk menutup surplus ini):</b><br>
    `;

    sports.forEach(s => {
      const hours = diff / (s.met * weight);
      const minutes = Math.ceil(hours * 60);
      html += `â€¢ ${s.name}: sekitar <b>${minutes} menit</b><br>`;
    });

    const walkingHours = diff / (3.3 * weight);
    const walkingKm = (walkingHours * 5).toFixed(1);
    html += `<br>â€¢ Jalan kaki: sekitar <b>${walkingKm} km</b>`;
  } else {
    html += `
      <b>Anda sudah tidak surplus kalori pada periode ini.</b><br>
      Defisit/Seimbang bukan berarti harus menambah olahraga â€” tetap jaga pola makan ðŸ˜Š
    `;
  }

  const out = document.getElementById("output");
  out.innerHTML = html;
  out.style.display = "block";
}
</script>
</body>
</html>
